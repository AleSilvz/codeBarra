<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Leitor de C贸digo de Barras</title>
</head>
<body>
  <h2>Escaneie um C贸digo de Barras</h2>

  <button id="iniciar"> Iniciar Leitura</button>
  <button id="parar" disabled> Parar Leitura</button>
  <br><br>

  <video id="video" width="300" height="200" style="border:1px solid black; display: none;"></video>
  <p id="codigo">C贸digo lido: nenhum</p>

  <!-- Biblioteca ZXing -->
  <script src="https://unpkg.com/@zxing/library@latest"></script>
  <script>
    const codeReader = new ZXing.BrowserMultiFormatReader();
    const video = document.getElementById("video");
    const btnIniciar = document.getElementById("iniciar");
    const btnParar = document.getElementById("parar");

    let currentDeviceId = null;

    btnIniciar.addEventListener("click", () => {
      video.style.display = "block";
      btnIniciar.disabled = true;
      btnParar.disabled = false;

      codeReader
        .listVideoInputDevices()
        .then(videoInputDevices => {
          currentDeviceId = videoInputDevices[0]?.deviceId;
          return codeReader.decodeFromVideoDevice(currentDeviceId, 'video', (result, err) => {
            if (result) {
              document.getElementById('codigo').innerText = "C贸digo lido: " + result.getText();
              // Se quiser parar a leitura automaticamente:
              // codeReader.reset();
              // btnIniciar.disabled = false;
              // btnParar.disabled = true;
            }
          });
        })
        .catch(err => console.error('Erro ao acessar c芒mera: ', err));
    });

    btnParar.addEventListener("click", () => {
      codeReader.reset();
      video.style.display = "none";
      btnIniciar.disabled = false;
      btnParar.disabled = true;
    });
  </script>
</body>
</html>
